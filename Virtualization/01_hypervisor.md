# 하이퍼바이저란?

하이퍼바이저는 `가상화를 구현한 소프트웨어`라고 정의할 수 있다. 그렇다면 가상화는 무엇일까?

`가상화`란, 간단히 표현하면 실제로 존재하지 않는 것을 존재하는 것처럼 가상으로 제공해주는 기술이다. 즉, 하이퍼바이저는 하나의 컴퓨터 시스템에서 마치 여러 대의 컴퓨터가 있는 것처럼 가상으로 제공해주는 소프트웨어라고 할 수 있다. 하이퍼바이저를 이용하면 컴퓨터 한 대에서 여러 대의 가상머신을 생성할 수 있다.

컴퓨터 시스템은 정말 복잡하지만, 모든 컴퓨터는 `CPU, 메모리, I/O 장치`를 가지고 있고 이들이 서로 복잡하게 연결되어 있는 구조이다. 그래서 컴퓨터를 가상화하기 위해서는 이 3가지를 가상화 해야한다. 이는 추후 하나씩 정리해볼 것이다.

# 하이퍼바이저의 종류

![image](https://github.com/Ohjiwoo-lab/TIL/assets/74577768/9b2ce0b5-7a74-42d0-a187-ffdfd9991626)   
출처: [위키백과](https://ko.wikipedia.org/wiki/%ED%95%98%EC%9D%B4%ED%8D%BC%EB%B0%94%EC%9D%B4%EC%A0%80)

앞서 하이퍼바이저는 가상화를 제공해주는 소프트웨어라고 했는데, 이 소프트웨어가 어디에 설치되느냐에 따라 2가지 타입으로 구분된다. `네이티브`라 불리는 타입1 하이퍼바이저와, `호스티드`라 불리는 타입2 하이퍼바이저이다.

## 타입1 하이퍼바이저 - Native

타입1 하이퍼바이저는 컴퓨터 시스템 바로 위에 설치되어 동작한다. 일반적인 컴퓨터는 운영체제가 설치된 후, 그 위에 애플리케이션이 설치된다. 하지만 타입1 하이퍼바이저는 운영체제의 역할을 대신하기 때문에 컴퓨터 시스템 위에 바로 설치될 수 있다.

하드웨어 위에 하이퍼바이저가 설치되면, 하이퍼바이저 상에서 여러 대의 가상머신을 생성할 수 있고, 각 가상머신은 독립적으로 운영체제를 설치하여 사용할 수 있다.

대표적인 타입1 하이퍼바이저에는 KVM, Xen이 있다. KVM은 타입2 하이퍼바이저라고도 생각될 수 있는데 이는 추후 다시 살펴볼 것이다. KVM은 오픈스택의 Nova 컴퓨트 머신에서 가상머신을 생성할 때 사용되는 하이퍼바이저이기도 하다.

> 컴퓨터 시스템 위에 바로 설치되어 운영체제처럼 동작

## 타입2 하이퍼바이저 - Hosted

타입2 하이퍼바이저는 운영체제 상에서 마치 애플리케이션처럼 동작한다. 일반적인 컴퓨터처럼 컴퓨터 시스템 위에 운영체제가 설치되고, 해당 운영체제 상에서 하이퍼바이저가 설치된다.

하이퍼바이저를 카카오톡을 사용하듯이 실행할 수 있고, 하이퍼바이저 상에서 여러 대의 가상머신을 생성하고, 각 가상머신에 독립적인 운영체제를 설치할 수 있다.

이때 기반이 되는 운영체제를 `호스트 OS`, 가상머신 상에 설치되는 운영체제를 `게스트 OS`라고 한다. 만약 윈도우 기반의 컴퓨터에 하이퍼바이저를 설치하고, 하이퍼바이저 상에 리눅스 기반의 가상머신을 생성한다면, 윈도우가 호스트 OS, 리눅스가 게스트 OS가 될 것이다.

타입2 하이퍼바이저는 호스트 OS에 의존성을 가지고 있으며, 여러 애플리케이션 중 하나로서 동작하기 때문에 성능 측면에서 타입1 하이퍼바이저보다 떨어질 수밖에 없다. 그래서 고성능을 요구하는 데이터센터 같은 경우에는 타입1 하이퍼바이저를 주로 사용한다.

대표적인 타입2 하이퍼바이저에는 VirtualBox, VMware Workstation 등이 있다.

> 호스트 운영체제에서 하나의 애플리케이션으로 동작

## KVM

앞서 KVM은 타입1 하이퍼바이저이면서 타입2 하이퍼바이저가 될 수 있다고 하였다. 그 이유는 KVM은 리눅스 커널의 모듈로서 설치되기 때문이다. KVM이 별도의 하이퍼바이저로서 동작하는 것이 아니라, 리눅스 커널에 설치됨으로써 리눅스 자체가 하이퍼바이저가 되어 동작하는 것이라고 이해하면 된다.

그래서 관점에 따라 다음과 같이 나뉠 수 있다.
1. KVM이 설치된 리눅스 커널 자체가 하이퍼바이저로 동작하므로 타입1 하이퍼바이저이다.
2. 결국 기반이 되는 리눅스 운영체제가 설치된 후, KVM이 설치되는 것이기 때문에 타입2 하이퍼바이저다.

이처럼 KVM을 명확하게 타입1과 타입2로 나눌 수는 없지만, 관점에 따라 다양하게 해석될 수 있다는 것을 알아두는 것도 좋을 것 같다.

<hr/>

📌 2023-12-15: 하이퍼바이저 정리   
📌 2024-2-14: 리팩토링