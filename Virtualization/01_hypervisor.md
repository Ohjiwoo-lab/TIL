# 하이퍼바이저란?

하이퍼바이저는 `가상화를 구현한 소프트웨어`라고 정의할 수 있습니다.

하나의 컴퓨터 시스템에서 여러 대의 가상머신을 생성할 수 있게 해주는 도구입니다. 이것이 가능한 이유는 가상화를 이용하기 때문입니다. 

`가상화`란, 간단히 표현하면 실제로 존재하지 않는 것을 존재하는 것처럼 가상으로 제공해주는 기술입니다. 그래서 하나의 컴퓨터 시스템에서 마치 여러 대의 컴퓨터가 있는 것처럼 가상으로 제공해주는 것이 하이퍼바이저라고 할 수 있습니다.

컴퓨터 시스템은 정말 복잡하지만, 모든 컴퓨터는 CPU, 메모리, I/O 장치를 가지고 있고 이들이 서로 복잡하게 연결되어 있는 구조입니다. 그래서 컴퓨터를 가상화하기 위해서는 이 3가지를 가상화해야합니다. 이는 추후 하나씩 정리해볼 것입니다.

하이퍼바이저는 2가지 종류로 구분됩니다. `네이티브`라 불리는 타입1 하이퍼바이저와, `호스티드`라 불리는 타입2 하이퍼바이저입니다.

![image](https://github.com/Ohjiwoo-lab/TIL/assets/74577768/41a758ad-bd03-4658-8b57-62af70cf1378)   
출처: https://ko.wikipedia.org/wiki/%ED%95%98%EC%9D%B4%ED%8D%BC%EB%B0%94%EC%9D%B4%EC%A0%80

## 타입1 하이퍼바이저

타입1은 컴퓨터 시스템 바로 위에 설치되어 동작합니다. 기본적인 컴퓨터는 운영체제가 설치된 후, 그 위에 애플리케이션이 설치됩니다. 하지만 타입1 하이퍼바이저는 운영체제의 역할을 대신하기 때문에 컴퓨터 시스템 위에 바로 설치될 수 있습니다.

그래서 하드웨어 위에 하이퍼바이저가 설치되면, 하이퍼바이저 상에서 여러 대의 가상머신을 생성할 수 있고, 각 가상머신은 독립적으로 운영체제를 설치하여 사용할 수 있습니다.

대표적인 타입1 하이퍼바이저에는 KVM, Xen이 있습니다. KVM은 타입2 하이퍼바이저라고도 생각될 수 있는데 이는 추후 살펴보겠습니다. KVM은 오픈스택의 Nova 컴퓨트 머신에서 가상머신을 생성할 때 사용되는 하이퍼바이저입니다.

## 타입2 하이퍼바이저

타입2는 운영체제 상에서 마치 애플리케이션처럼 동작합니다. 컴퓨터 시스템 위에 운영체제가 설치되고, 해당 운영체제 상에서 하이퍼바이저가 설치됩니다. 하이퍼바이저는 타입1과 마찬가지로 여러 대의 가상머신을 생성하고, 각 가상머신에 독립적인 운영체제를 설치할 수 있습니다.

그래서 기반이 되는 운영체제를 `호스트 OS`, 가상머신 상에 설치되는 운영체제를 `게스트 OS`라고 합니다.

대표적인 타입2 하이퍼바이저에는 VirtualBox, VMware Workstation 등이 있습니다. 이는 호스트 운영체제에서 하나의 애플리케이션으로 동작합니다.

타입2 하이퍼바이저는 호스트 OS에 의존성을 가지고 있으며, 여러 애플리케이션 중 하나로서 동작하기 때문에 성능 측면에서 타입1 하이퍼바이저보다 떨어질 수밖에 없습니다. 그래서 고성능을 요구하는 데이터센터에서는 타입1 하이퍼바이저를 사용합니다.

## KVM

앞서 KVM은 타입1 하이퍼바이저이면서 타입2 하이퍼바이저가 될 수 있다고 하였습니다. 그 이유는 KVM은 리눅스 커널의 모듈로서 설치되기 때문입니다. KVM이 별도의 하이퍼바이저로서 동작하는 것이 아니라, 리눅스 커널에 설치됨으로써 리눅스 자체가 하이퍼바이저가 되어 동작하는 것입니다.

그래서 관점에 따라 다음과 같이 나뉠 수 있습니다.
1. KVM이 설치된 리눅스 커널 자체가 하이퍼바이저로 동작하므로 타입1 하이퍼바이저이다.
2. 결국 기반이 되는 리눅스 운영체제가 설치된 후, KVM이 설치되는 것이기 때문에 타입2 하이퍼바이저다.

이처럼 KVM을 명확하게 타입1과 타입2로 나눌 수는 없지만, 관점에 따라 다양하게 해석될 수 있다는 것을 알아두는 것도 좋을 것 같습니다.

😃 2023-12-15 두번째 TIL 완료!