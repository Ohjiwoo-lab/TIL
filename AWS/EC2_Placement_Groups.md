# EC2 배치 그룹

EC2 인스턴스를 생성하면 기본적으로 무작위로 배치된다. 그런데 워크로드에 따라 인스턴스를 특정한 방식으로 배치하고 싶을 수도 있다. 그럴 때 사용하는 것이 `EC2 배치 그룹`이다.

인스턴스를 배치하는 전략에는 3가지가 존재한다. 하나씩 살펴보자.

## 1. Cluster

![image](https://github.com/Ohjiwoo-lab/TIL/assets/74577768/65b500a5-8595-46ba-bd1f-c517b5f41ae0)

첫 번째는 클러스터 배치 그룹이다. 이는 모든 EC2 인스턴스가 동일한 가용 영역의 동일한 하드웨어에 배치되는 형태이다. 

EC2 인스턴스 간 거리가 가깝기 때문에 지연시간이 최소화된다는 장점이 있다. 인스턴스 사이에 10 Gbps 수준의 네트워크 성능을 보여주며, 향상된 네트워킹을 가능하게 해주는 ENA나 EFA를 사용한다면 성능을 더욱 극대화할 수 있을 것이다.

하지만 모든 인스턴스가 동일한 하드웨어에 배치되기 때문에 하드웨어의 장애가 전체 시스템의 Down으로 이어질 수 있다는 단점이 존재한다.

하지만 최고의 성능을 보여줄 수 있는 만큼 빅데이터 작업이나 적은 지연시간과 높은 처리량이 필요한 애플리케이션에 적합한 전략이다.

> - 장점: 지연시간 최소화, 성능 극대화
> - 단점: 하드웨어의 장애 시 모든 시스템이 다운됨

## 2. Spread

![image](https://github.com/Ohjiwoo-lab/TIL/assets/74577768/9d8568ba-a165-47f3-a6b0-2aaf6c89fe22)

이는 분산 배치 그룹으로, 클러스터 배치 그룹과 상반된 개념이라고 생각하면 된다. 이 방식은 모든 EC2 인스턴스가 서로 다른 하드웨어에 배치된다.

가용 영역 당 총 7개의 인스턴스가 배치될 수 있고, 인스턴스는 모두 다른 하드웨어 랙에 배치되며, 여러 가용 영역에 분산되어 있다. 가용성을 극대화하였기 때문에 하드웨어 장애, 가용 영역에 대한 장애가 발생하더라도 서비스를 정상적으로 운영할 수 있다. 그래서 절대 중단되어서는 안되는 애플리케이션이나 고가용성이 요구되는 애플리케이션에 적합한 방식이다. 

하지만 가용 영역 당 배치할 수 있는 인스턴스가 7개로 제한되어 있기 때문에 많은 인스턴스를 운영할 수 없으며, 지연시간이 다소 소요될 수 있다는 단점이 있다.

> - 장점: 고가용성 확보
> - 단점: 높은 지연시간, 인스턴스 개수 제한

## 3. Partition

![image](https://github.com/Ohjiwoo-lab/TIL/assets/74577768/b03cb842-5589-40ad-bbba-2252560e1cc5)

파티션 배치 그룹은 Spread 방식보다 더 많은 수의 인스턴스를 사용할 수 있으면서 Cluster 방식보다는 가용성을 높인 방식이다.

가용 영역 당 총 7개의 파티션이 존재할 수 있다. 여기서 파티션이란 하나의 하드웨어라고 이해하면 된다. 그리고 파티션 당 수백 개의 인스턴스가 배치될 수 있다.

즉 하나의 가용 영역에 수백 개의 많은 인스턴스가 배치되면서도 파티션으로 구분되어 있는 인스턴스는 서로 다른 하드웨어에 속해있기 때문에 하드웨어 장애에 독립적이라는 장점이 있다.

해당 방식은 많은 인스턴스를 운영할 수 있기 때문에 인스턴스가 많이 필요한 Hadoop, Cassandra, Kafka와 같은 서비스에 주로 사용된다.

> - 장점: 많은 수의 인스턴스 운영 가능, 클러스터보다는 가용성 높임
> - 단점: 파티션의 장애로 수백 개의 인스턴스가 한 번에 다운될 가능성이 있음

# Reference

[Udemy 강의 - AWS Certified Solutions Architect Professional](https://www.udemy.com/course/aws-csa-professional/?couponCode=KRLETSLEARNNOW)

# History

📌 2024-3-19: EC2 배치 그룹 3가지 정리   