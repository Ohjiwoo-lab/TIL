# DR 시스템이란?

인프라를 설계할 때 DR 시스템은 아주 중요하다. DR은 Disaster Recovery의 약자로, 재해 복구 시스템을 의미한다. DR은 지진과 태풍과 같은 외부적인 요인이나, 시스템 결함, Human Error와 같은 내부적인 요인에 의해 서비스가 중단되었을 때 이를 정상화시키는 행위를 의미한다.

그렇다면 장애가 발생하더라도 시스템이 정상적으로 운영되기 위해서는 어떻게 해야할까?

바로 시스템을 이중화해야 한다. 사실상 인프라 구축 시 장애에 대응하기 위해서는 이중화밖에 방법이 없을 것이다. 기존의 데이터센터와 물리적으로 떨어진 지역에 백업 데이터를 저장하고 있는 또 하나의 데이터센터를 구축해야 한다. 이를 `DR 센터`라고 한다. DR 센터가 있다면 기존의 데이터센터에 문제가 생겼을 때 빠르게 DR 센터로 서비스를 지속적으로 운영할 수 있을 것이다.

**RTO와 RPO에 대해 알아봅시다!**
> - 복구 시간 목표 (RTO, Recovery Time Objective): 재해 발생 시 복구하는 데에 걸리는 시간을 말한다. 만약 RTO가 4시간 이라면, 장애 발생 후 4시간 내에 서비스가 정상으로 복구될 수 있도록 보장한다는 의미이다.
> - 복구 시점 목표 (RPO, Recovery Point Objective): 재해 발생 시 어느 정도의 데이터 손실을 허용할 수 있는 지에 대한 것이다. 그래서 RPO는 백업 시간을 의미한다. 만약 RPO가 4시간 이라면, 4시간 마다 백업이 이루어진다는 것이다. 그러면 마지막 백업 이후 2시간 뒤에 재해가 발생했다면, 2시간 동안의 데이터는 손실된다. 즉, 최대 4시간 동안의 데이터에 대해 손실이 발생할 수 있다는 의미이다. 너무 백업을 자주 하면 용량이 너무 커지기 때문에 어느 정도의 손실까지 감당할 수 있을지를 고려해서 RPO를 설정하는 것이 좋다.

DR 시스템은 RTO와 RPO에 따라 4가지로 구분할 수 있다.

1. Mirror Site

    DR 센터를 기존의 데이터 센터와 정확하게 동일한 환경으로 구축하고 실시간으로 데이터를 동기화하면서 Active 상태로 운영하는 방식이다. 데이터가 실시간으로 전송되므로 이론적인 RPO는 0이며, 장애 발생 시 바로 트래픽을 DR 센터로 이동하면 되기 때문에 이론적인 RTO도 0일 것이다. 장애 대응에 아주 좋은 방식이지만, 동일한 데이터센터 2개를 동시에 가동해야 한다는 점에서 비용이 많이 발생한다는 단점이 있다.

    > 절대 장애가 일어나면 안되는 금융 시스템의 경우 정부 차원에서 Mirror Site를 강제하고 있다고 한다.

2. Hot Site

    Mirror Site와 유사하게 DR 센터를 기존의 데이터센터와 동일한 환경으로 구축하고 데이터를 실시간으로 동기화한다. 그런데 Hot Site는 DR 센터를 Standby 상태로 구축한다. 즉, 기존의 데이터센터와 완벽하게 동일하지만, 평소에는 가동되지 않는 상태를 유지하다가, 재해가 발생했을 때 Active 상태로 전환하여 가동한다는 차이점이 있다. 데이터는 실시간으로 동기화되므로 RPO는 0이지만, Standby에서 Active로 전환되어야 하므로 RTO는 약 4시간 정도라고 한다.

3. Warm Site

    DR 센터를 기존의 데이터센터와 동일한 환경으로 구축하되, 중요도가 높은 데이터만 부분적으로 저장하는 방식이다. 중요도가 높지 않은 데이터의 경우 수 시간~1일 단위로 백업을 진행하고, RTO도 수일~수주가 발생한다고 한다. 구축 비용과 유지보수 비용이 상대적으로 저렴하지만, 중요도가 높지 않은 데이터의 경우 수 시간~1일 동안의 데이터 손실이 발생할 수 있다.

4. Cold Site

    이는 정말 최소한의 수준으로 DR 센터를 구축하여 최소한의 데이터만을 저장하는 방식이다. 데이터 백업은 수일~수주 단위로 진행하며, 복구 시간도 수주~수개월이 걸린다고 한다. 모든 방식 중에 가장 저렴한 방법이지만, RTO가 매우 길고, 데이터 손실이 많이 발생할 수 있다. 그래서 이를 단독으로 사용하기 보다는 Mirror Site나 Hot Site를 보안하는 방식으로 많이 사용된다.

Mirror Site > Hot Site > Warm Site > Cold Site 순으로 RTO/RPO가 짧다. 하지만 RTO/RPO가 짧을 수록 비용이 많이 발생하기 때문에, 비지니스 목표에 따라 적절히 선택하면 될 것이다.

또한 최근에는 DR 센터를 클라우드로 제공하는 DRaaS 서비스도 제공하고 있다고 한다. 별도로 DR 센터를 구축할 필요 없이 DRaaS를 제공하는 기업의 데이터센터로 데이터를 동기화하는 방식이다. 만약 비용이 많이 발생하지 않으면서 안정적으로 서비스를 운영하고 싶다면, DRaaS를 사용하는 것도 좋은 방법이라고 생각한다.

# Reference

[가비아 - 재해 복구(DR), 기업을 지키는 가장 확실한 방법](https://library.gabia.com/contents/infrahosting/12209/)

# History

📌 2024-4-7: DR 시스템 4가지 정리