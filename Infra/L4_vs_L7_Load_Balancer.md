# L4와 L7 로드밸런서의 차이점과 장단점

로드밸런서는 여러 서버에 트래픽을 분산해주는 하드웨어 또는 소프트웨어이다. 로드밸런서의 종류에 L4와 L7이 있는데 차이점과 장단점을 비교해보자.

## L4 로드밸런서

L4 로드밸런서는 데이터 전송 계층(Layer 4)에서 동작하는 로드밸런서로, TCP와 UDP에 대한 트래픽을 분산해준다. 트래픽 분산을 할 때에 IP와 포트번호를 이용하기 때문에 가능한 기능은 다소 제한적이라는 단점이 있다. 정교한 트래픽 분산은 불가능하고 특정 IP, 포트번호를 통해서만 분산이 가능하다. 하지만  트래픽이 Layer 7까지 갈 필요 없이 Layer 4에서만 전달되기 때문에 속도가 빠르다는 장점이 있다. 

그래서 온라인 게임, 스트리밍 서비스 등 처리 속도가 중요한 서비스의 경우 L4 로드밸런서를 사용하는 것이 좋다. AWS에서는 Network Load Balancer를 L4 로드밸런서로 제공해주고 있다.

## L7 로드밸런서

L7 로드밸런서는 애플리케이션 계층(Layer 7)에서 동작하는 로드밸런서로, HTTP, HTTPS에 대한 트래픽을 분산해준다. 이는 L4 로드밸런서와 달리 보다 상위 계층에서의 트래픽 전달이 가능하기 때문에 다양한 기능을 사용할 수 있다. HTTP 헤더, URL, 쿠키 등을 기반으로 정교한 트래픽 분산이 가능한 것이다. 예를 들어 결제만 하는 서버와 이메일만 전송하는 서버가 있을 경우, /payment에 대한 요청은 결제 서버로, /email에 대한 요청은 이메일 서버로 트래픽 분산이 가능하다. 하지만 애플리케이션 계층에서 분석해야 하는 정보의 양이 많아지다 보니 L4 로드밸런서보다 느린 처리 속도를 가진다는 단점이 있다.

그래서 웹 서비스, API 게이트웨이, 콘텐츠 전송 네트워크(CDN) 등의 애플리케이션 레벨에서의 정교한 트래픽 분산이 필요할 때 사용하는 것이 좋다. AWS에서는 Application Load Balancer를 L7 로드밸런서로 제공해준다.

> AWS에서 구현한 로드밸런서가 궁금하다면 [로드밸런서 3가지 종류와 요청 라우팅 알고리즘](https://github.com/Ohjiwoo-lab/TIL/blob/main/AWS/Load_Balancer.md)를 참고하자. AWS에서는 L3에서 동작하는 게이트웨이 로드밸런서도 제공해주고 있다.

어떤 것을 중요하게 생각하느냐에 따라 L4와 L7 중 어느 것을 선택할 지를 결정할 수 있다. 만약 많은 기능을 필요로 하지 않고 빠른 속도를 원할 경우에는 L4를 사용하는 것이 좋고, URL 기반의 라우팅이 필요한 경우에는 L7을 사용하는 것이 좋다.

# Reference

[L4와 L7 로드밸런서의 차이점](https://velog.io/@moonblue/L4와-L7-로드밸런서의-차이점)

# History

📌 2024-5-9: L4와 L7 로드밸런서의 차이점, 장단점 비교   