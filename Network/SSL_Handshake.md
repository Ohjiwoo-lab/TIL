# SSL Handshake

SSL Handshake 과정은 클라이언트와 서버간 SSL 암호화를 진행하기 위해 진행된다. SSL은 전송 중 암호화하는 방법을 제공하는 것으로, HTTPS 프로토콜이 SSL을 이용하여 암호화된다. 전송 중에 데이터를 가로채는 중간자 공격을 방지하기 위해 전송 중 암호화를 진행한다. 암호화되어 있으면 중간에 가로채더라도 어떤 데이터인지 알아낼 수 없기 때문이다.

> 사실 요즘 SSL보다 더 발전된 버전인 TLS를 주로 사용하지만 많은 사람들이 아직 SSL이라고 부르기 때문에 편의상 SSL이라고 명시하겠다.

SSL 통신을 하기 위해서는 SSL 인증서가 필요하다. SSL 인증서는 공인 CA 또는 AWS ACM을 통해 발급받을 수 있으며, AWS의 경우 ACM과 IAM을 통해 SSL 인증서를 관리할 수 있다. SSL 통신을 위해 서버에 SSL 인증서를 업로드해야 한다.

SSL Handshake 과정은 다음과 같다.

1. 클라이언트는 `hello` 패킷을 서버에 보낸다.

2. 서버는 hello 패킷에 대한 응답으로 `SSL 인증서`와 `서버의 퍼블릭 키`를 클라이언트에 보낸다.

3. 클라이언트는 SSL 인증서를 공인 CA를 통해 확인한다.
    
    - CA는 Certificate Authority로, SSL 인증서를 발급하고 인증해주는 기관이다.

    - CA를 통해 SSL 인증서가 정상적인 것인지 확인이 가능하다.

4. 인증이 완료되면 클라이언트는 SSL 데이터 통신에 사용될 `마스터 키`를 생성한다.
    
    - 이때 마스터 키는 대칭키이다.

5. 클라이언트는 생성한 마스터 키를 서버의 `퍼블릭 키로 암호화`한 뒤 서버에 전송한다.

6. 서버는 본인의 `프라이빗 키`를 이용하여 마스터 키를 `복호화`한다.

7. 마스터 키를 이용하여 모든 데이터를 암호화하여 전송한다. (SSL 암호화 성립)

SSL 암호화에서 Handshake 과정에서는 반드시 비대칭키 암호화 방식을 사용해야 한다. 공개키를 이용해 암호화하고 개인키를 이용해 복호화해야 한다는 것이다. 하지만 비대칭키 암호화 방식은 비싸기 때문에 전송되는 모든 데이터를 암호화하는 데에 사용될 수 없다. 그래서 실제 데이터 암호화에 사용되는 `마스터 키`를 암$\cdot$복호화하는 데만 비대칭키 암호 방식을 사용하고, 마스터 키는 대칭키 암호화 방식으로 동작한다.

# Reference

[Udemy 강의 - AWS Certified Solutions Architect Professional](https://www.udemy.com/course/aws-csa-professional/?couponCode=KRLETSLEARNNOW)

# History

📌 2024-4-28: SSL Handshake 과정 정리   