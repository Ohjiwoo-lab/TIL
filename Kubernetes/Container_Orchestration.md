# 컨테이너 오케스트레이션이란?

애플리케이션을 배포하는 방법으로 도커를 이용한 컨테이너 기술이 각광을 받으면서 대부분의 기업에서 컨테이너 기술을 도입하기 시작했다. 컨테이너는 굉장히 편리한 기능을 많이 제공해주고 있지만, 컨테이너의 개수가 무수히 많아진다면 관리하기 복잡해질 수 밖에 없다. 서버에 직접 SSH 접근하여 컨테이너를 실행하고, 새롭게 생성된 컨테이너의 IP와 포트를 등록해주어야 하며, 컨테이너에 문제가 생기면 이를 일일히 교체해야 한다. 물론 사람이 직접 수행할 수도 있지만, 시간이 오래걸리고 수정하는 동안 사용자가 애플리케이션을 이용하는 데에 불편을 겪을 수 있다. 그래서 이러한 모든 작업을 자동으로 수행해주는 `컨테이너 오케스트레이션` 기술이 등장했고, 그 가운데 가장 많이 사용되는 것이 쿠버네티스이다.

쿠버네티스는 구글에서 개발한 오픈소스로, 현재 컨테이너 환경에서는 거의 표준으로 자리잡고 있다. 오픈소스이기 때문에 빠르게 발전하며 다양한 기술을 지원하게 되었고, 거의 대부분의 환경에서 사용할 수 있으며, 뛰어난 확장성을 가지고 있기 때문에 많은 사랑을 받고 있다.

그러면 컨테이너 오케스트레이션이 수행하는 작업을 하나씩 알아보자.

> 이는 쿠버네티스만의 고유의 기능이 아니며, 대규모 컨테이너 환경에서 컨테이너를 보다 효율적으로 관리, 운영하기 위한 방법론이다.

## 1. Cluster

무수히 많은 컨테이너를 클러스터라는 하나의 논리적인 단위로 묶고, 이를 중앙에서 한 번에 제어한다. 이제 서버 관리자는 중앙 컨트롤 노드에만 접근하여 명령어를 입력하면 자동으로 모든 컨테이너에 명령어가 적용될 것이다.

## 2. State

언제나 동일한 상태를 유지한다. 사용할 컨테이너의 개수, 버전 등의 정보를 상태로서 관리하는데, 컨테이너 오케스트레이션은 이 상태를 유지하기 위해 동작한다. 만약 컨테이너 개수를 3개라고 정의했다면, 어떤 상황이라도 3개의 컨테이너가 실행되는 것을 보장한다. 3개의 컨테이너가 실행되다가 1개의 컨테이너에 오류가 발생하여 제대로 동작하지 못하게 된다면, 새로운 컨테이너를 생성하여 컨테이너 개수를 3개로 유지할 것이다. 이런 식으로 컨테이너에 문제가 생겨도 문제없이 애플리케이션이 실행될 수 있도록 도와준다.

## 3. Scheduling

어느 서버에 컨테이너를 배치할 지를 스스로 결정할 수 있다. 어떤 서버에 어떤 컨테이너들이 실행되고 있는지, 어떤 서버가 현재 여유 공간이 있는지를 지속적으로 모니터링하다가 새로운 컨테이너가 실행되어야 할 때 이를 적절한 서버에 배치시킨다. 만약 배치할 수 있는 공간이 없다면 새로운 서버를 생성한 뒤 그 곳에 컨테이너를 배치할 수도 있다.

## 4. Roll Out & Roll Back

클러스터에 존재하는 모든 컨테이너에 한 번에 새로운 버전을 배포할 수 있고, 새로운 버전에 문제가 생긴다면 한 번에 Roll Back 할 수 있다. 이전에는 사람이 일일히 수행해야 했던 작업을 이제 명령어 하나만 입력하면 손쉽게 수행할 수 있다.

## 5. Service Discovery

프록시 서버(nginx)를 통해 컨테이너로 트래픽을 전달하는 경우, 새로운 컨테이너가 생성되면 해당 컨테이너로 트래픽이 전달될 수 있도록 프록시 서버에 등록하는 기능을 수행한다.

## 6. Volume

컨테이너가 동작하기 위해서 필요한 스토리지 볼륨을 자동으로 추가해준다. AWS의ㅣ 경우 EBS 볼륨을 생성한 뒤 EC2 인스턴스에 이를 마운트하는 작업을 수행해야 하는데, 이를 컨테이너에 맞게 자동으로 수행해준다.

<br/>

이처럼 컨테이너 오케스트레이션은 대규모의 컨테이너를 효율적으로 관리할 수 있는 다양한 기능을 제공해주고 있다. 컨테이너 오케스트레이션을 지원하는 도구가 많이 있지만 (ECS도 그 중 하나) 쿠버네티스가 현재 대세 기술이니, 제대로 배워보고자 한다!

# Reference

[초보를 위한 쿠버네티스 안내서](https://www.inflearn.com/course/%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EC%9E%85%EB%AC%B8/dashboard)

# History

📌 2024-6-9: 컨테이너 오케스트레이션이란?